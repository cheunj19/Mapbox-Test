<!DOCTYPE html>
<html>
<head>
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.css' rel='stylesheet' />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel = "stylesheet" type="text/css" href="styles.css">
</head>




<body>
  <div class='sidebar'>
    <div class='heading'>
      <h1>Locations</h1>
    </div>
    <div id='listings' class='listings'></div>
    </div>
  <div id='map' class='map pad2'>Map</div>
  <script>
  // This will let you use the .remove() function later on
    if (!('remove' in Element.prototype)) {
    Element.prototype.remove = function() {
      if (this.parentNode) {
        this.parentNode.removeChild(this);
      }
    };
    }
  	mapboxgl.accessToken = 'pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2lqbmpqazdlMDBsdnRva284cWd3bm11byJ9.V6Hg2oYJwMAxeoR9GEzkAA';
    var bounds = [
       [-74.457092, 40.490826], // Southwest coordinates
       [-73.506775, 40.952937]  // Northeast coordinates
     ];


  	// This adds the map to your page
  	var map = new mapboxgl.Map({
      // container id specified in the HTML
      container: 'map',
      // style URL
      style: 'mapbox://styles/mapbox/streets-v9',
      // initial position in [long, lat] format
      center: [-73.9978, 40.7209],
         zoom: 0,
         maxBounds: bounds // Sets bounds as max
      });

    var stores = {
      "type": "FeatureCollection",
                 "features": [{
                     "type": "Feature",
                     "properties": {
                        "title": "Manhattan Animal Care Center",
                         "description": "<p>326 East 110th Street New York, NY 10029</p><p><a href=\"http://www.nycacc.org/Volunteer.htm\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Animal Care</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-73.93944599999998, 40.79245399999999]
                     }
                 }, {
                     "type": "Feature",
                     "properties": {
                        "title": "Brooklyn Animal Care Center",
                         "description": "<p>2336 Linden Boulevard Brooklyn, NY 11208</p><p><a href=\"http://www.nycacc.org/Volunteer.htm\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Animal Care</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-73.87650510000003, 40.6638009]
                     }
                 }, {
                     "type": "Feature",
                     "properties": {
                        "title": "Staten Island Animal Care Center",
                         "description": "<p>3139 Veterans Road West Staten Island, NY 10309</p><p><a href=\"http://www.nycacc.org/Volunteer.htm\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Animal Care</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-74.2379459, 40.527916]
                     }
                   }, {
                         "type": "Feature",
                         "properties": {
                            "title": "ASPCA Adoption Center",
                             "description": "<p>424 E 92nd St, New York, NY 10128</p><p><a href=\"https://www.aspca.org/take-action/volunteer/volunteer-aspca-adoption-center\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Animal Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.94572499999998, 40.7801062]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "Visiting Nurse Service of New York",
                             "description": "<p>1150 South Ave # 302, Staten Island, NY 10314</p><p><a href=\"https://www.vnsny.org/giving/volunteer/hospice-volunteer-opportunities/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.17775289999997, 40.6119832]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "Visiting Nurse Service of New York",
                             "description": "<p>7520 Astoria Blvd, East Elmhurst, NY 11370</p><p><a href=\"https://www.vnsny.org/giving/volunteer/hospice-volunteer-opportunities/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.89315069999998, 40.7645332]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "Visiting Nurse Service of New York",
                             "description": "<p>1630 E 15th St, Brooklyn, NY 11229</p><p><a href=\"https://www.vnsny.org/giving/volunteer/hospice-volunteer-opportunities/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.95843239999999, 40.6094476]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "Visiting Nurse Service of New York",
                             "description": "<p>1250 Broadway, New York, NY 100019</p><p><a href=\"https://www.vnsny.org/giving/volunteer/hospice-volunteer-opportunities/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.98796270000003, 40.7478473]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Visiting Nurse Service of New York",
                             "description": "<p>400 Lake Ave, Staten Island, NY 10303</p><p><a href=\"https://www.vnsny.org/giving/volunteer/hospice-volunteer-opportunities/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.15207420000002, 40.6260456]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Visiting Nurse Service of New York",
                             "description": "<p>13226 Avery Ave, Flushing, NY 11355</p><p><a href=\"https://www.vnsny.org/giving/volunteer/hospice-volunteer-opportunities/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.83146390000002, 40.7524574]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Isabella",
                             "description": "<p>515 Audubon Avenue, New York, NY 10040</p><p><a href=\"http://www.isabella.org/Isabella/Help\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.92753429999999, 40.8545202]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                           "title": "Visiting Neighbors",
                             "description": "<p>3 Washington Square Village #1, New York, NY 10012</p><p><a href=\"http://www.visitingneighbors.org/Activities-for-Seniors-New-York-City-NY.html\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Elderly Care</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.99797160000003, 40.7278058]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "New York Presbyterian Brooklyn Methodist Hospital",
                             "description": "<p>506 6th St Brooklyn NY 11215</p><p><a href=\"http://www.nyp.org/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.97941759999998, 40.6679815]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "New York Presbyterian / Columbia University Hospital",
                             "description": "<p>622 West 168th Street New York NY 10032</p><p><a href=\"http://www.nyp.org/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.9407372, 40.8411547]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "New York Presbyterian Allen Hospital",
                             "description": "<p>5141 Broadway New York NY 10034</p><p><a href=\"http://www.nyp.org/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.91296740000001, 40.87326789999999]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "New York Presbyterian Queens",
                             "description": "<p>56-45 Main Street Flushing NY 11355</p><p><a href=\"http://www.nyp.org/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.82514309999999, 40.7471206]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "NYU Langone Hospital - Brooklyn",
                             "description": "<p>150 55th Street Brooklyn, NY 11220</p><p><a href=\"http://nyulangone.org/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.02153709999999, 40.64675809999999]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "NYU Langone Hospital Orthopedic Hospital",
                             "description": "<p>301 East 17th Street New York, NY 10003</p><p><a href=\"http://nyulangone.org/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.98321349999998, 40.7342366]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Memorial Sloan Kettering Bergen",
                             "description": "<p>225 Summit Ave, Montvale, NJ 07645</p><p><a href=\"https://www.mskcc.org/about/get-involved/volunteering\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.071437, 41.05736]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Memorial Sloan Kettering 55th Street Imaging Center",
                             "description": "<p>300 E 56th St, New York, NY 10022</p><p><a href=\"https://www.mskcc.org/about/get-involved/volunteering\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.96530229999996, 40.75815269999999]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Jersey City Medical Center",
                             "description": "<p>355 Grand St, Jersey City, NJ 07302</p><p><a href=\"http://www.barnabashealth.org/Jersey-City-Medical-Center/Volunteer.aspx\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Medical Services</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.05026570000001, 40.7163312]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                            "title": "St. Mary's Church Clothing Drive",
                             "description": "<p>230 Classon Ave, Brooklyn, NY 11205</p><p><a href=\"http://www.stmarysclothingdrive.org/index.php?r=site%2Fpickup\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Donation</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.9611064, 40.6926353]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "The Bowery Mission",
                             "description": "<p>227 Bowery, New York, NY 10002</p><p><a href=\"https://www.bowery.org/donate/donate-goods/donate-clothes/\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Donation</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.99283500000001, 40.72196700000001]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "New York Cares",
                             "description": "<p>65 Broadway, New York, NY 10006</p><p><a href=\"https://www.newyorkcares.org/projects/volunteer-homeless-shelter\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Homeless Shelter</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.0126, 40.7073]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Hoboken Homeless Shelter",
                             "description": "<p>300 Bloomfield St, Hoboken, NJ 07030</p><p><a href=\"http://hobokenshelter.org/volunteers\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Homeless Shelter</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-74.0311, 40.7403]
                         }
                     }, {
                         "type": "Feature",
                         "properties": {
                             "title": "Long Island Cares",
                             "description": "<p>10 Davids Dr, Hauppauge, NY 11788</p><p><a href=\"https://www.licares.org/make-a-difference/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Homeless Shelter</p>",
                             "icon": "star"
                         },
                         "geometry": {
                             "type": "Point",
                             "coordinates": [-73.2572, 40.8194]
                         }
                   }, {
                       "type": "Feature",
                       "properties": {
                           "title": "Homeless Solutions",
                           "description": "<p>540 W Hanover Ave, Morristown, NJ 07960</p><p><a href=\"https://www.homelesssolutions.org/how-you-can-help/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Homeless Shelter</p>",
                           "icon": "star"
                       },
                       "geometry": {
                           "type": "Point",
                           "coordinates": [-74.5212, 40.8313]
                       }
                   }, {
                       "type": "Feature",
                       "properties": {
                           "title": "Upper East Side Donor Center",
                           "description": "<p>310 East 67th Street New York, NY 10065</p><p><a href=\"http://nybloodcenter.org/donate-blood/where-to-donate-today\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Blood Donation!</p>",
                           "icon": "star"
                       },
                       "geometry": {
                           "type": "Point",
                           "coordinates": [-74.2379459, 40.527916]
                       }
                   }, {
                       "type": "Feature",
                       "properties": {
                           "title": "Grand Central Donor Center",
                           "description": "<p>200 Park Avenue New York, NY 10017</p><p><a href=\"http://nybloodcenter.org/donate-blood/where-to-donate-today\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Blood Donation!</p>",
                           "icon": "star"
                       },
                       "geometry": {
                           "type": "Point",
                           "coordinates": [-73.9778, 40.7524]
                       }
                 }, {
                     "type": "Feature",
                     "properties": {
                         "title": "Port Authority Donor Center",
                         "description": "<p>625 Eighth Avenue New York, NY 10018</p><p><a href=\"http://nybloodcenter.org/donate-blood/where-to-donate-today\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Blood Donation!</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-73.9905, 40.7569]
                     }
               }, {
                   "type": "Feature",
                   "properties": {
                       "title": "NYPD Manhattan North 24th Precint",
                       "description": "<p>151 West 100th Street New York, NY 10025</p><p><a href=\"http://nybloodcenter.org/donate-blood/where-to-donate-today\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Blood Donation!</p>",
                       "icon": "star"
                   },
                   "geometry": {
                       "type": "Point",
                       "coordinates": [-73.9671, 40.7965]
                   }
                 }, {
                     "type": "Feature",
                     "properties": {
                         "title": "NYC Parks",
                         "description": "<p>24 W 61st St, New York, NY 10023</p><p><a href=\"https://www.nycgovparks.org/opportunities/volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Parks and Rec</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-73.9828, 40.7698]
                     }
                 }, {
                     "type": "Feature",
                     "properties": {
                         "title": "The Whitney",
                         "description": "<p>99 Gansevoort St, New York, NY 10014</p><p><a href=\"http://whitney.org/About/Volunteer\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Parks and Rec</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-74.0088, 40.7820]
                     }
                 }, {
                     "type": "Feature",
                     "properties": {
                         "title": "American Museum Of Natural History",
                         "description": "<p>Central Park West & 79th St, New York, NY 10024</p><p><a href=\"http://www.amnh.org/join-support/volunteer-now\" target=\"_blank\" title=\"Opens in a new window\">Link to website</a></p><p>Parks and Rec</p>",
                         "icon": "star"
                     },
                     "geometry": {
                         "type": "Point",
                         "coordinates": [-73.9717, 40.7820]
                     }
                 }]
             }
  	// This adds the data to the map
    // This adds the data to the map
      map.on('load', function (e) {
          // This is where your '.addLayer()' used to be, instead add only the source without styling a layer
          map.addSource("places", {
            "type": "geojson",
            "data": stores
          });
          // Initialize the list
          buildLocationList(stores);
        });
        // This is where your interactions with the symbol layer used to be
        // Now you have interactions with DOM markers instead
        stores.features.forEach(function(marker, i) {
          // Create an img element for the marker
          var el = document.createElement('div');
          el.id = "marker-" + i;
          el.className = 'marker';
          // Add markers to the map at all points
          new mapboxgl.Marker(el, {offset: [0,0]})
              .setLngLat(marker.geometry.coordinates)
              .addTo(map);

          el.addEventListener('click', function(e){
              // 1. Fly to the point
              flyToStore(marker);

              // 2. Close all other popups and display popup for clicked store
              createPopUp(marker);

              // 3. Highlight listing in sidebar (and remove highlight for all other listings)
              var activeItem = document.getElementsByClassName('active');

              e.stopPropagation();
              if (activeItem[0]) {
                 activeItem[0].classList.remove('active');
              }

              var listing = document.getElementById('listing-' + i);
              listing.classList.add('active');
          });
        });


        function flyToStore(currentFeature) {
          map.flyTo({
              center: currentFeature.geometry.coordinates,
              zoom: 0
            });
        }

        function createPopUp(currentFeature) {
          var popUps = document.getElementsByClassName('mapboxgl-popup');
          if (popUps[0]) popUps[0].remove();


          var popup = new mapboxgl.Popup({closeOnClick: false})
                .setLngLat(currentFeature.geometry.coordinates)
                .setHTML('<h3>' + currentFeature.properties.title + '</h3>' +
                  '<h4>' + currentFeature.properties.description + '</h4>')
                .addTo(map);
        }


        function buildLocationList(data) {
          for (i = 0; i < data.features.length; i++) {
            var currentFeature = data.features[i];
            var prop = currentFeature.properties;

            var listings = document.getElementById('listings');
            var listing = listings.appendChild(document.createElement('div'));
            listing.className = 'item';
            listing.id = "listing-" + i;

            var link = listing.appendChild(document.createElement('a'));
            link.href = '#';
            link.className = 'title';
            link.dataPosition = i;
            link.innerHTML = prop.title;

            var details = listing.appendChild(document.createElement('div'));
            details.innerHTML = prop.description;
          }

            el.addEventListener('click', function(e) {
              var activeItem = document.getElementsByClassName('active');
              // 1. Fly to the point
              flyToStore(marker);
              // 2. Close all other popups and display popup for clicked store
              createPopUp(marker);
              // 3. Highlight listing in sidebar (and remove highlight for all other listings)
              e.stopPropagation();
              if (activeItem[0]) {
                activeItem[0].classList.remove('active');
              }
              var listing = document.getElementById('listing-' + i);
              console.log(listing);
              listing.classList.add('active');
            });


            // Add an event listener for the links in the sidebar listing
            link.addEventListener('click', function(e) {
              // Update the currentFeature to the store associated with the clicked link
              var clickedListing = data.features[this.dataPosition];
              // 1. Fly to the point associated with the clicked link
              flyToStore(clickedListing);
              // 2. Close all other popups and display popup for clicked store
              createPopUp(clickedListing);
              // 3. Highlight listing in sidebar (and remove highlight for all other listings)
              var activeItem = document.getElementsByClassName('active');
              if (activeItem[0]) {
                activeItem[0].classList.remove('active');
              }
              this.parentNode.classList.add('active');
            });

            // Add an event listener for when a user clicks on the map
            map.on('click', function(e) {
            // Query all the rendered points in the view
            var features = map.queryRenderedFeatures(e.point, { layers: ['locations'] });
            if (features.length) {
              var clickedPoint = features[0];
              // 1. Fly to the point
              flyToStore(clickedPoint);
              // 2. Close all other popups and display popup for clicked store
              createPopUp(clickedPoint);
              // 3. Highlight listing in sidebar (and remove highlight for all other listings)
              var activeItem = document.getElementsByClassName('active');
              if (activeItem[0]) {
                activeItem[0].classList.remove('active');
              }
              // Find the index of the store.features that corresponds to the clickedPoint that fired the event listener
              var selectedFeature = clickedPoint.properties.address;

              for (var i = 0; i < stores.features.length; i++) {
                if (stores.features[i].properties.address === selectedFeature) {
                  selectedFeatureIndex = i;
                }
              }
              // Select the correct list item using the found index and add the active class
              var listing = document.getElementById('listing-' + selectedFeatureIndex);
              listing.classList.add('active');
            }
          });}

              // 3. Highlight listing in sidebar (and remove highlight f…
  </script>
</body>
</html>
